var express = require('express');
var router = express.Router();
var usuario = require('../models/usuario');

/* GET users listing. */
router.get('/:id?nombre',function(req,res,next){
	if(req.params.id){
		usuario.getUserById(req.params.id,function(err,rows){
			if(err){
			  res.json(err);
  			}
  			else{
  			  res.json(rows);
  			}
 		 });
	}
	else{
		if(req.params.nombre){
			usuarios.getUserByName(req.params.nombre, function(err, rows){
				if(err){
					res.json(err);
				}else{
					res.json(rows);
				}
			)};

		}else{
			usuario.getAllUsers(function(err,rows){ 
				if(err){
				  res.json(err);
	  			}
  				else{
				  res.js	on(rows);
  					}
				 });
			}	
		}
 	}
 });
/* POST users */
router.post('/',function(req,res,next){
	usuario.addUser(req.body,function(err,rows){
		console.log(req.body.nombre);
		if(err){
		  res.json(err);
  		}
  		else{
  		  res.json(req.body);//or return count for 1 &amp;amp;amp; 0
  		}
	});
});

/*DELETE users*/
router.delete('/:id?', function(req, res, next){
	if(req.params.id){
		usuario.deleteUser(req.params.id, function(err, rows){
			if(err){
				res.json(err);
			}else{
				var respuesta ={
					Resultado: 'OK',
					Descripcion: 'Usuario eliminado correctamente'
				};
				res.json(respuesta);
			}		
		});
	}
});

/*UPDATE users*/
router.put('/:id', function(req, res, next){
	if(req.params.id){
		usuario.updateUser(req.params.id, req.body, function(err , rows){
			if(err){
				res.json(err);
			}else{
				var respuesta = {
					Resultado: 'OK',
					Descripcion: 'Usuario modificado correctamente'
				};
				res.json(respuesta);
			}
		});
	}
});


module.exports = router;
